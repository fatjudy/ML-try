---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.4.1
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

# Chapter 5 Getting Started with Pandas

```{python}
import pandas as pd
import numpy as np
from pandas import Series, DataFrame
```

## 5.1 Introduction to pandas Data Structures


### Seriesï¼š one-dimensional array-like object containing a sequence of values and an associated array of data labels, called its index.

```{python}
obj = pd.Series([4, 7, -5, 3])
obj
```

```{python}
obj2 = pd.Series([4, 7, -5, 3], index = ['a', 'b', 'n', 'c'])
obj
```

```{python}
obj2['c']
```

```{python}
obj2[obj2 > 0]
```

```{python}
np.exp(obj2)
```

```{python}
# Create a series from dict
sdata = {'Ohio': 35000, 'Texas': 71000, 'Oregon': 16000, 'Utah': 5000}
obj3 = pd.Series(sdata)
obj3
```

```{python}
# For matched index, the values can be passed into the new series;
state = ['California', 'Ohio', 'Oregon', 'Texas']
obj4 = pd.Series(sdata, state)
obj4
```

```{python}
# Check null
pd.isnull(obj4)
```

```{python}
pd.notnull(obj4)
```

```{python}
obj4.name = 'Population'
obj4.index.name = 'state'
obj4
```

```{python}
# Change index
obj.index = ['Rob', 'Ryan', 'George', 'Nick']
obj
```

### DataFrame

```{python}
# Generate a DataFrame
data = {'state': ['Ohio', 'Ohio', 'Ohio', 'Nevada', 'Nevada', 'Nevada'],
        'year': [2000, 2001, 2002, 2001, 2002, 2003],
        'pop': [1.5, 1.7, 3.6, 2.4, 2.9, 3.2]}
frame = pd.DataFrame(data)
frame
```

```{python}
frame.head()
```

```{python}
# Change the order of the columns
pd.DataFrame(data, columns = ['year', 'state', 'pop'])
```

```{python}
frame2 = pd.DataFrame(data, columns = ['year', 'state', 'pop', 'debt'], index = ['one', 'two', 'three', 'four', 'five', 'six'])
frame2
```

```{python}
# Retrieve a column
frame2.year
```

```{python}
# Retrieve a row
frame2.loc['three']
```

```{python}
# Give value to a column
frame2['debt'] = 10
frame2
```

```{python}
# Give certain cells values
val = pd.Series([1.2, 1.5, -1.7], index = ['two', 'four', 'five'])
frame2['debt'] = val
frame2
```

```{python}
frame2['eastern'] = frame2.state =='Ohio'
frame2
```

```{python}
# delete a column
del frame2['eastern']
frame2
```

```{python}
# Nested dict to a dataframe: pandas will interpret the outer keys as the columns and the inner keys as the row indices
pop = {'Nevada':{2001:2.4, 2002:4.9}, 'Ohio':{2000:1.9, 2001:3.4, 2002:4.1}}
frame3 = pd.DataFrame(pop)
frame3
```

```{python}
# Transpose
frame3.T
```

```{python}
pd.DataFrame(pop, index = [2001, 2002, 2003])
```

```{python}
frame3.index.name = 'year'; frame3.columns.name = 'state'
frame3
```

```{python}
frame3.values
```

```{python}
frame2.values
```

### Index Objects

```{python}
obj = pd.Series(range(3), index = ['a', 'b', 'c'])
index = obj.index
index
```

```{python}
index[1:]
```

```{python}
labels = pd.Index(np.arange(3))
labels
```

```{python}
obj2 = pd.Series([1.5, -2.5, 0], index = labels)
obj2
```

```{python}
obj2.index 
```
